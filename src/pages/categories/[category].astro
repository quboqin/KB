---
import BaseLayout from '@/layouts/BaseLayout.astro';
import PostList from '@/components/blog/PostList.astro';
import { getAllPosts, getAllCategories } from '@/utils/posts';

export async function getStaticPaths() {
  const categories = await getAllCategories();
  const posts = await getAllPosts();

  return categories.map(({ name }) => ({
    params: { category: name },
    props: {
      category: name,
      posts: posts.filter(p => p.data.category === name),
    },
  }));
}

const { category, posts } = Astro.props;

const categoryIcons: Record<string, string> = {
  'æŠ€æœ¯': 'ğŸ’»',
  'é‡‘è': 'ğŸ“ˆ',
  'AI': 'ğŸ¤–',
  'ç”Ÿæ´»': 'ğŸŒ±',
  'å…¶ä»–': 'ğŸ“Œ',
};
const icon = categoryIcons[category] ?? 'ğŸ“‚';
---

<BaseLayout title={`${icon} ${category}`} description={`åˆ†ç±»ã€Œ${category}ã€ä¸‹çš„æ‰€æœ‰æ–‡ç« `}>
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
    <div class="mb-10">
      <a href="/"
         class="text-sm text-slate-500 hover:text-indigo-600 dark:text-slate-400 dark:hover:text-indigo-400 transition-colors">
        â† è¿”å›é¦–é¡µ
      </a>
      <h1 class="text-3xl font-medium text-slate-900 dark:text-white mt-4 mb-2">
        {icon} {category}
      </h1>
      <p class="text-slate-600 dark:text-slate-400">{posts.length} ç¯‡æ–‡ç« </p>
    </div>
    <PostList posts={posts} />
  </div>
</BaseLayout>
